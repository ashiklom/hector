<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A tour of the Hector R interface • hector</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="A tour of the Hector R interface">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hector</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/manual/index.html">Manual</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/intro-to-hector.html">A tour of the Hector R interface</a>
    </li>
    <li>
      <a href="../articles/hector_apply.html">Example: Using Hector to solve for an emissions pathway</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/JGCRI/hector">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>A tour of the Hector R interface</h1>
                        <h4 class="author">Alexey Shiklomanov</h4>
            
            <h4 class="date">2018-10-17</h4>
      
      
      <div class="hidden name"><code>intro-to-hector.Rmd</code></div>

    </div>

    
    
<p>This vignette provides a basic introduction for running Hector with R. First, it shows how to do a simple Hector run with one of Hector’s built-in scenarios. Then, it shows how to modify Hector parameters from within R and uses this functionality to perform a simple sensitivity analysis of how the CO<span class="math inline">\(_2\)</span> fertilization parameter <span class="math inline">\(\beta\)</span> affects several Hector output variables.</p>
<div id="basic-run" class="section level1">
<h1 class="hasAnchor">
<a href="#basic-run" class="anchor"></a>Basic run</h1>
<p>First, load the <code>hector</code> package.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(hector) </span></code></pre></div>
<p>Hector is configured via an INI file, which defines run metadata, inputs (e.g. emissions scenarios), and parameters. For details on this file, see <a href="https://github.com/JGCRI/hector/wiki/InputFiles">InputFiles</a> on the Hector GitHub Wiki.</p>
<p>These files ship with the Hector R package, in the <code>input</code> subdirectory, which allows them to be accessed via <code>system.file</code>. Below, we get the path of the input file corresponding to the scenario RCP 4.5.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>ini_file &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/system.file">system.file</a></span>(<span class="st">"input/hector_rcp45.ini"</span>, <span class="dt">package =</span> <span class="st">"hector"</span>) </span></code></pre></div>
<p>Next, we initialize a Hector instance, or “core”, using this configuration. This core is a self-contained object that contains information about all of Hector’s inputs and outputs. The core is initialized via the <code>newcore</code> function:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>core &lt;-<span class="st"> </span><span class="kw"><a href="../reference/newcore.html">newcore</a></span>(ini_file)</span>
<span id="cb3-2"><a href="#cb3-2"></a>core </span></code></pre></div>
<pre><code>## Hector core: unnamed hector core
## Start date:  1745
## End date:    2300
## Current date:    1745
## Input file:  /Users/shik544/R/hector/input/hector_rcp45.ini</code></pre>
<p>Now that we have configured a Hector core, we can run it with the <code>run</code> function.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw"><a href="../reference/run.html">run</a></span>(core) </span></code></pre></div>
<pre><code>## Hector core: unnamed hector core
## Start date:  1745
## End date:    2300
## Current date:    2300
## Input file:  /Users/shik544/R/hector/input/hector_rcp45.ini</code></pre>
<p>Notice that this itself returns no output. Instead, the output is stored inside the core object. To retrieve it, we use the <code>fetchvars</code> function. Below, we also specify that we want to retrieve results for the years 2000 to 2300.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>results &lt;-<span class="st"> </span><span class="kw"><a href="../reference/fetchvars.html">fetchvars</a></span>(core, <span class="dv">2000</span><span class="op">:</span><span class="dv">2300</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(results) </span></code></pre></div>
<pre><code>##              scenario year variable    value    units
## 1 unnamed hector core 2000       Ca 353.0744 ppmv CO2
## 2 unnamed hector core 2001       Ca 354.6760 ppmv CO2
## 3 unnamed hector core 2002       Ca 356.3236 ppmv CO2
## 4 unnamed hector core 2003       Ca 358.0162 ppmv CO2
## 5 unnamed hector core 2004       Ca 359.7927 ppmv CO2
## 6 unnamed hector core 2005       Ca 361.7058 ppmv CO2</code></pre>
<p>The results are returned as a long, <a href="https://cran.r-project.org/web/packages/tidyr/vignettes/tidy-data.html">tidy</a> <code>data.frame</code>. This makes it easy to plot them using <code>ggplot2</code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)</span>
<span id="cb9-2"><a href="#cb9-2"></a></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(results) <span class="op">+</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> year, <span class="dt">y =</span> value) <span class="op">+</span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>() <span class="op">+</span></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="op">~</span>variable, <span class="dt">scales =</span> <span class="st">"free_y"</span>)</span></code></pre></div>
<p><img src="intro-to-hector_files/figure-html/plot-1.png" width="700"></p>
</div>
<div id="setting-parameters" class="section level1">
<h1 class="hasAnchor">
<a href="#setting-parameters" class="anchor"></a>Setting parameters</h1>
<p>The Hector R interface interacts with parameters and variables in the same way. Therefore, the variables can be set and checked via <code>setvar</code> and <code>fetchvars</code>, respectively.</p>
<p>First, let’s get the current value of <span class="math inline">\(\beta\)</span> (beta), the CO<span class="math inline">\(_2\)</span> fertilization factor. Because variables and parameter names have to be retrieved from the Hector core, they are stored as R functions (e.g. <code><a href="../reference/parameters.html">BETA()</a></code>). However, these functions simply return a string corresponding to the variable name.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw"><a href="../reference/parameters.html">BETA</a></span>()</span></code></pre></div>
<pre><code>## [1] "beta"</code></pre>
<p>Just as we did to load results, we use <code>fetchvars</code> to query parameter values.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>beta &lt;-<span class="st"> </span><span class="kw"><a href="../reference/fetchvars.html">fetchvars</a></span>(core, <span class="ot">NA</span>, <span class="kw"><a href="../reference/parameters.html">BETA</a></span>())</span>
<span id="cb12-2"><a href="#cb12-2"></a>beta </span></code></pre></div>
<pre><code>##              scenario year variable value      units
## 1 unnamed hector core   NA     beta  0.36 (unitless)</code></pre>
<p>The result of <code>fetchvars</code> is always a <code>data.frame</code> with the same columns, even when returning a parameter value. Note also the use of <code>NA</code> in the second argument (<code>dates</code>).</p>
<p>The current value is set to 0.36 (note that it is a unitless quantity, hence the <code>(unitless)</code> unit). Let’s bump it up a little to 0.40.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw"><a href="../reference/setvar.html">setvar</a></span>(core, <span class="ot">NA</span>, <span class="kw"><a href="../reference/parameters.html">BETA</a></span>(), <span class="fl">0.40</span>, <span class="st">"(unitless)"</span>) </span></code></pre></div>
<p>Similarly to <code>run</code>, this returns no output. Rather, the change is stored inside the Hector “core” object. We can confirm that our change took effect with another call to <code>fetchvars</code>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw"><a href="../reference/fetchvars.html">fetchvars</a></span>(core, <span class="ot">NA</span>, <span class="kw"><a href="../reference/parameters.html">BETA</a></span>()) </span></code></pre></div>
<pre><code>##              scenario year variable value      units
## 1 unnamed hector core   NA     beta   0.4 (unitless)</code></pre>
<p>Now, let’s run the simulation again with a higher value for CO2 fertilization. But, before we do, let’s look once again at the Hector <code>core</code> object.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>core</span></code></pre></div>
<pre><code>## Hector core: unnamed hector core
## Start date:  1745
## End date:    2300
## Current date:    2300
## Input file:  /Users/shik544/R/hector/input/hector_rcp45.ini</code></pre>
<p>Notice that <code>Current date</code> is set to 2300. This is because we have already run this core to its end date. The ability to stop and resume Hector runs with the same configuration, possibly with adjusting values of certain variables while stopped, is an essential part of the model’s functionality. But, it’s not something we’re interested in here. We have already stored the previous run’s output in <code>results</code> above, so we can safely reset the core here.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw"><a href="../reference/reset.html">reset</a></span>(core)</span></code></pre></div>
<pre><code>## Hector core: unnamed hector core
## Start date:  1745
## End date:    2300
## Current date:    1745
## Input file:  /Users/shik544/R/hector/input/hector_rcp45.ini</code></pre>
<p>This will effectively “rewind” the core back to either the provided <code>date</code> (defaults to 0 if missing) or the model start date (set in the INI file; default is 1745), whichever is greater. In addition, if the <code>date</code> argument is less than the model start date and spinup is enabled (<code>do_spinup = 1</code> in the INI file), then the core will re-do its spinup process with the current set of parameters.</p>
<hr>
<p><strong>NOTE</strong></p>
<p>Because changing Hector parameters can change the post-spinup equilibrium values of state variables, Hector will automatically run <code><a href="../reference/reset.html">reset(core, date = 0)</a></code> at the beginning of the next <code>run</code> call if it detects that any of its parameters have changed. This means that is not currently possible to change Hector <em>parameters</em> (such as <span class="math inline">\(\beta\)</span> or preindustrial CO<sub>2</sub>) part-way through a run. However, it is still possible to change the values of certain <em>drivers</em> and <em>state variables</em> (such as the CO<sub>2</sub> emissions) in the middle of a run.</p>
<hr>
<p>So, as a result of the <code>reset</code> command, the core’s “Current Date” is now the model start date–1745. We can now perform another run with the new CO<span class="math inline">\(_2\)</span> fertilization value.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="kw"><a href="../reference/run.html">run</a></span>(core)</span></code></pre></div>
<pre><code>## Hector core: unnamed hector core
## Start date:  1745
## End date:    2300
## Current date:    2300
## Input file:  /Users/shik544/R/hector/input/hector_rcp45.ini</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>results_<span class="dv">40</span> &lt;-<span class="st"> </span><span class="kw"><a href="../reference/fetchvars.html">fetchvars</a></span>(core, <span class="dv">2000</span><span class="op">:</span><span class="dv">2300</span>)</span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(results_<span class="dv">40</span>) </span></code></pre></div>
<pre><code>##              scenario year variable    value    units
## 1 unnamed hector core 2000       Ca 350.6232 ppmv CO2
## 2 unnamed hector core 2001       Ca 352.1657 ppmv CO2
## 3 unnamed hector core 2002       Ca 353.7535 ppmv CO2
## 4 unnamed hector core 2003       Ca 355.3855 ppmv CO2
## 5 unnamed hector core 2004       Ca 357.1007 ppmv CO2
## 6 unnamed hector core 2005       Ca 358.9513 ppmv CO2</code></pre>
<p>Let’s see how changing the CO2 fertilization affects our results.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>results[[<span class="st">"beta"</span>]] &lt;-<span class="st"> </span><span class="fl">0.36</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>results_<span class="dv">40</span>[[<span class="st">"beta"</span>]] &lt;-<span class="st"> </span><span class="fl">0.40</span></span>
<span id="cb25-3"><a href="#cb25-3"></a>compare_results &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">rbind</a></span>(results, results_<span class="dv">40</span>)</span>
<span id="cb25-4"><a href="#cb25-4"></a></span>
<span id="cb25-5"><a href="#cb25-5"></a><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(compare_results) <span class="op">+</span></span>
<span id="cb25-6"><a href="#cb25-6"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> year, <span class="dt">y =</span> value, <span class="dt">color =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(beta)) <span class="op">+</span></span>
<span id="cb25-7"><a href="#cb25-7"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>() <span class="op">+</span></span>
<span id="cb25-8"><a href="#cb25-8"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="op">~</span>variable, <span class="dt">scales =</span> <span class="st">"free_y"</span>) <span class="op">+</span></span>
<span id="cb25-9"><a href="#cb25-9"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span>(<span class="dt">color =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span>(<span class="dt">title =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/expression">expression</a></span>(beta)))</span></code></pre></div>
<p><img src="intro-to-hector_files/figure-html/compare-co2-fert-1.png" width="700"></p>
<p>As expected, increasing CO2 fertilization increases the strength of the terrestrial carbon sink and therefore reduces atmospheric CO2, radiative forcing, and global temperature. However, the effects only become pronounced in the latter half of the 21st Century.</p>
</div>
<div id="sensitivity-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#sensitivity-analysis" class="anchor"></a>Sensitivity analysis</h1>
<p>Hector runs fairly quickly, which makes it easy to run lots of simulations under slightly different configurations. One application of this is to explore the sensitivity of Hector to variability in its parameters.</p>
<p>The basic procedure for this is the same as in the previous section. However, to save typing (and, in general, to be good programmers!), let’s create some functions.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="co">#' Run Hector with a parameter set to a particular value, and return results </span></span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="co">#'</span></span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="co">#' @param core Hector core to use for execution</span></span>
<span id="cb26-4"><a href="#cb26-4"></a><span class="co">#' @param parameter Hector parameter name, as a function call (e.g.</span></span>
<span id="cb26-5"><a href="#cb26-5"></a><span class="co">#'   `BETA()`)</span></span>
<span id="cb26-6"><a href="#cb26-6"></a><span class="co">#' @param value Parameter value</span></span>
<span id="cb26-7"><a href="#cb26-7"></a><span class="co">#' @param dates Sequence of years for running simulation (default = #'</span></span>
<span id="cb26-8"><a href="#cb26-8"></a><span class="co">#'   `2000:2300`)</span></span>
<span id="cb26-9"><a href="#cb26-9"></a><span class="co">#' @param ini_file Hector parameter file (default = RCP 4.5 file)</span></span>
<span id="cb26-10"><a href="#cb26-10"></a><span class="co">#' @return Results, as data.frame, with additional `parameter_value`</span></span>
<span id="cb26-11"><a href="#cb26-11"></a><span class="co">#'   column</span></span>
<span id="cb26-12"><a href="#cb26-12"></a>run_with_param &lt;-<span class="st"> </span><span class="cf">function</span>(core, parameter, value) {</span>
<span id="cb26-13"><a href="#cb26-13"></a>  old_value &lt;-<span class="st"> </span><span class="kw"><a href="../reference/fetchvars.html">fetchvars</a></span>(core, <span class="ot">NA</span>, parameter)</span>
<span id="cb26-14"><a href="#cb26-14"></a>  unit &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/character">as.character</a></span>(old_value[[<span class="st">"units"</span>]])</span>
<span id="cb26-15"><a href="#cb26-15"></a>  <span class="kw"><a href="../reference/setvar.html">setvar</a></span>(core, <span class="ot">NA</span>, parameter, value, unit)</span>
<span id="cb26-16"><a href="#cb26-16"></a>  <span class="kw"><a href="../reference/reset.html">reset</a></span>(core)</span>
<span id="cb26-17"><a href="#cb26-17"></a>  <span class="kw"><a href="../reference/run.html">run</a></span>(core)</span>
<span id="cb26-18"><a href="#cb26-18"></a>  result &lt;-<span class="st"> </span><span class="kw"><a href="../reference/fetchvars.html">fetchvars</a></span>(core, <span class="dv">2000</span><span class="op">:</span><span class="dv">2300</span>)</span>
<span id="cb26-19"><a href="#cb26-19"></a>  result[[<span class="st">"parameter_value"</span>]] &lt;-<span class="st"> </span>value</span>
<span id="cb26-20"><a href="#cb26-20"></a>  result</span>
<span id="cb26-21"><a href="#cb26-21"></a>}</span>
<span id="cb26-22"><a href="#cb26-22"></a></span>
<span id="cb26-23"><a href="#cb26-23"></a><span class="co">#' Run Hector with a range of parameter values</span></span>
<span id="cb26-24"><a href="#cb26-24"></a>run_with_param_range &lt;-<span class="st"> </span><span class="cf">function</span>(core, parameter, values) {</span>
<span id="cb26-25"><a href="#cb26-25"></a>  mapped &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/funprog">Map</a></span>(<span class="cf">function</span>(x) <span class="kw">run_with_param</span>(core, parameter, x), values)</span>
<span id="cb26-26"><a href="#cb26-26"></a>  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/funprog">Reduce</a></span>(rbind, mapped)</span>
<span id="cb26-27"><a href="#cb26-27"></a>}</span>
<span id="cb26-28"><a href="#cb26-28"></a></span>
<span id="cb26-29"><a href="#cb26-29"></a>sensitivity_beta &lt;-<span class="st"> </span><span class="kw">run_with_param_range</span>(core, <span class="kw"><a href="../reference/parameters.html">BETA</a></span>(), <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.05</span>))</span>
<span id="cb26-30"><a href="#cb26-30"></a></span>
<span id="cb26-31"><a href="#cb26-31"></a><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(sensitivity_beta) <span class="op">+</span></span>
<span id="cb26-32"><a href="#cb26-32"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> year, <span class="dt">y =</span> value, <span class="dt">color =</span> parameter_value, <span class="dt">group =</span> parameter_value) <span class="op">+</span></span>
<span id="cb26-33"><a href="#cb26-33"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>() <span class="op">+</span></span>
<span id="cb26-34"><a href="#cb26-34"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="op">~</span>variable, <span class="dt">scales =</span> <span class="st">"free_y"</span>) <span class="op">+</span></span>
<span id="cb26-35"><a href="#cb26-35"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span>(<span class="dt">color =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/guide_colourbar.html">guide_colorbar</a></span>(<span class="dt">title =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/expression">expression</a></span>(beta))) <span class="op">+</span></span>
<span id="cb26-36"><a href="#cb26-36"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_color_viridis_c</a></span>() </span></code></pre></div>
<p><img src="intro-to-hector_files/figure-html/functions-1.png" width="700"></p>
<p>As we can see, the ability of CO<span class="math inline">\(_2\)</span> fertilization to offset carbon emissions is saturating – at high values of <span class="math inline">\(\beta\)</span>, the same increase in <span class="math inline">\(\beta\)</span> translates into a smaller decrease in atmospheric CO<span class="math inline">\(_2\)</span> and related climate effects.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#basic-run">Basic run</a></li>
      <li><a href="#setting-parameters">Setting parameters</a></li>
      <li><a href="#sensitivity-analysis">Sensitivity analysis</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Robert Link, Corinne Hartin, Ben Bond-Lamberty, Pralit Patel.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
